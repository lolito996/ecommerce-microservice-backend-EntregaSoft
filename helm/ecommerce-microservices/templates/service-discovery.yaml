{{- if index .Values "service-discovery" "enabled" }}
{{- $service := index .Values "service-discovery" }}
{{ include "microservice.deployment" (dict "name" $service.name "port" $service.port "replicas" $service.replicas "resources" $service.resources "healthCheck" (dict "path" ($service.healthCheck.path | default "/actuator/health") "readiness" $.Values.global.healthCheck.readiness "liveness" $.Values.global.healthCheck.liveness) "Values" $.Values "Chart" $.Chart "Release" $.Release) }}

---
{{ include "microservice.service" (dict "name" $service.name "port" $service.port "serviceType" $service.serviceType "nodePort" $service.nodePort "Values" $.Values "Chart" $.Chart "Release" $.Release) }}
{{- end }}

